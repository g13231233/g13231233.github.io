<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>宝可梦抽卡游戏</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --gray: #a0a0a0;
            --green: #78c850;
            --blue: #6890f0;
            --purple: #a040a0;
            --red: #f85888;
            --rainbow: linear-gradient(45deg, #ff9a9e, #fad0c4, #fbc2eb, #a6c1ee, #c2e9fb, #a1c4fd);
            --app-bg: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            --tab-bg: rgba(0, 20, 40, 0.95);
            --card-bg: rgba(30, 60, 90, 0.7);
            --accent: #ffd700;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Segoe UI', sans-serif;
        }
        
        body {
            background: var(--app-bg);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 70px; /* 为底部导航栏留出空间 */
        }
        
        /* 顶部应用栏 */
        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0, 30, 60, 0.9);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo h1 {
            font-size: 20px;
            background: linear-gradient(to right, gold, #ff8c00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .logo-icon {
            font-size: 24px;
            color: gold;
            filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.7));
        }
        
        .points-display {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(0, 40, 80, 0.7);
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px solid rgba(100, 200, 255, 0.3);
            box-shadow: 0 0 10px rgba(65, 105, 225, 0.3);
        }
        
        .points-value {
            font-size: 22px;
            font-weight: bold;
            color: var(--accent);
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.7);
        }
        
        .settings-btn {
            background: transparent;
            border: none;
            color: var(--accent);
            font-size: 22px;
            cursor: pointer;
            padding: 5px;
            transition: all 0.3s ease;
        }
        
        .settings-btn:hover {
            transform: rotate(30deg);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }
        
        /* 主内容区 */
        .main-content {
            padding: 15px;
            position: relative;
            overflow-y: auto;
            height: calc(100vh - 130px);
        }
        
        /* 移除所有内部滚动条 */
        .pokemon-grid, .gacha-results, .collection-grid {
            overflow-y: visible !important;
            max-height: none !important;
        }
        
        /* 移除滚动条样式 */
        .pokemon-grid::-webkit-scrollbar, 
        .gacha-results::-webkit-scrollbar, 
        .collection-grid::-webkit-scrollbar {
            display: none;
        }
        
        .pokeball-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 0, 0, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.1) 0%, transparent 20%);
            z-index: -1;
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .section-title {
            font-size: 26px;
            margin: 15px 0 20px;
            text-align: center;
            color: var(--accent);
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 25%;
            width: 50%;
            height: 3px;
            background: linear-gradient(to right, transparent, gold, transparent);
        }
        
        /* 打工区域样式 */
        .working-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .working-slots {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .slot {
            height: 160px;
            background: var(--card-bg);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 15px;
            border: 2px dashed rgba(100, 200, 255, 0.4);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .slot.occupied {
            border: 2px solid rgba(100, 255, 100, 0.5);
            background: rgba(20, 80, 40, 0.4);
        }
        
        .working-pokemon {
            text-align: center;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .working-pokemon:hover {
            transform: scale(1.05);
        }
        
        .working-pokemon img {
            width: 60px;
            height: 60px;
            object-fit: contain;
            filter: drop-shadow(0 0 6px rgba(255, 255, 255, 0.6));
        }
        
        .working-pokemon .name {
            font-weight: bold;
            margin-top: 8px;
            font-size: 14px;
        }
        
        .working-pokemon .earning {
            font-size: 13px;
            color: #7cfc00;
            margin-top: 3px;
        }
        
        .available-pokemon {
            background: rgba(0, 30, 60, 0.7);
            border-radius: 15px;
            padding: 15px;
        }
        
        .available-title {
            text-align: center;
            margin-bottom: 12px;
            color: #7cfc00;
            font-size: 18px;
        }
        
        .pokemon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            gap: 12px;
            padding: 8px;
        }
        
        .pokemon-card {
            background: rgba(50, 100, 150, 0.5);
            border-radius: 10px;
            padding: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .pokemon-card:hover {
            transform: translateY(-5px);
            border: 2px solid gold;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }
        
        .pokemon-card img {
            width: 55px;
            height: 55px;
            object-fit: contain;
        }
        
        .pokemon-card .name {
            font-size: 12px;
            margin-top: 5px;
        }
        
        /* 抽卡区域样式 */
        .gacha-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .gacha-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            width: 100%;
            justify-content: center;
        }
        
        .gacha-btn {
            background: linear-gradient(to right, #ff8c00, #ff4500);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            max-width: 160px;
            justify-content: center;
        }
        
        .gacha-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .gacha-btn:disabled {
            background: linear-gradient(to right, #555, #777);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .gacha-results {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            min-height: 180px;
            margin-top: 15px;
            padding: 10px;
            width: 100%;
        }
        
        .gacha-card {
            width: 100px;
            height: 150px;
            background: rgba(30, 30, 50, 0.8);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 8px;
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .gacha-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: rotate(45deg);
            z-index: 0;
        }
        
        .gacha-card.reveal {
            transform: rotateY(360deg);
        }
        
        .gacha-card img {
            width: 65px;
            height: 65px;
            object-fit: contain;
            z-index: 1;
            filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.7));
        }
        
        .gacha-card .name {
            margin-top: 8px;
            font-weight: bold;
            z-index: 1;
            text-align: center;
            font-size: 12px;
        }
        
        .gacha-card .rarity {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            z-index: 1;
        }
        
        /* 宠物仓库样式 */
        .collection-container {
            background: rgba(0, 30, 60, 0.7);
            border-radius: 15px;
            padding: 15px;
        }
        
        .collection-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 8px 15px;
            background: rgba(0, 50, 100, 0.5);
            border-radius: 10px;
            font-size: 14px;
        }
        
        .collection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 15px;
            padding: 8px;
        }
        
        .collection-card {
            background: rgba(40, 80, 120, 0.6);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .collection-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 215, 0, 0.5);
        }
        
        .collection-card img {
            width: 75px;
            height: 75px;
            object-fit: contain;
            margin-bottom: 8px;
            filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.5));
        }
        
        .collection-card .name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .collection-card .rarity-tag {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: bold;
        }
        
        /* 稀有度颜色 */
        .rarity-gray { color: var(--gray); }
        .rarity-green { color: var(--green); }
        .rarity-blue { color: var(--blue); }
        .rarity-purple { color: var(--purple); }
        .rarity-red { color: var(--red); }
        .rarity-rainbow { 
            background: var(--rainbow);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }
        
        .bg-gray { background-color: var(--gray); }
        .bg-green { background-color: var(--green); }
        .bg-blue { background-color: var(--blue); }
        .bg-purple { background-color: var(--purple); }
        .bg-red { background-color: var(--red); }
        .bg-rainbow { background: var(--rainbow); }
        
        /* 底部导航栏 */
        .tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--tab-bg);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.4);
            z-index: 100;
        }
        
        .tab-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
            color: #aaa;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 10px;
            width: 70px;
        }
        
        .tab-btn i {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .tab-btn.active {
            color: var(--accent);
            transform: translateY(-5px);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .tab-btn.active i {
            filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.7));
        }
        
        /* 设置弹窗 */
        .settings-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .settings-modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background: rgba(0, 30, 60, 0.95);
            border-radius: 20px;
            padding: 25px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 0 30px rgba(0, 100, 255, 0.5);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        
        .settings-modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-title {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--accent);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .modal-actions {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 25px;
        }
        
        .modal-btn {
            padding: 15px;
            border-radius: 12px;
            border: none;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .reset-btn {
            background: linear-gradient(to right, #ff4757, #ff6b81);
            color: white;
        }
        
        .close-btn {
            background: linear-gradient(to right, #4169e1, #6a5acd);
            color: white;
        }
        
        .modal-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        /* 响应式设计 */
        @media (max-width: 480px) {
            .working-slots {
                grid-template-columns: 1fr;
            }
            
            .gacha-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .gacha-btn {
                max-width: 220px;
            }
            
            .app-header {
                padding: 12px 15px;
            }
            
            .points-value {
                font-size: 20px;
            }
            
            .logo h1 {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <!-- 顶部应用栏 -->
    <div class="app-header">
        <div class="logo">
            <i class="fas fa-dragon logo-icon"></i>
            <h1>宝可梦抽卡</h1>
        </div>
        
        <div class="points-display">
            <span class="points-value" id="points">100</span>
            <i class="fas fa-coins" style="color: gold;"></i>
        </div>
        
        <button class="settings-btn" id="settings-btn">
            <i class="fas fa-cog"></i>
        </button>
    </div>
    
    <!-- 主内容区 -->
    <div class="main-content">
        <div class="pokeball-bg"></div>
        
        <!-- 打工区 -->
        <div class="section active" id="working-section">
            <h2 class="section-title">打工</h2>
            <div class="working-container">
                <div class="working-slots">
                    <div class="slot" id="slot-1">
                        <div class="slot-content"></div>
                    </div>
                    <div class="slot" id="slot-2">
                        <div class="slot-content"></div>
                    </div>
                    <div class="slot" id="slot-3">
                        <div class="slot-content"></div>
                    </div>
                    <div class="slot" id="slot-4">
                        <div class="slot-content"></div>
                    </div>
                </div>
                
                <div class="available-pokemon">
                    <h3 class="available-title">选择宝可梦打工</h3>
                    <div class="pokemon-grid" id="available-pokemon">
                        <!-- 动态生成可用宝可梦 -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 抽卡区 -->
        <div class="section" id="gacha-section">
            <h2 class="section-title">抽卡</h2>
            <div class="gacha-container">
                <div class="gacha-buttons">
                    <button class="gacha-btn pulse" id="single-gacha">
                        <i class="fas fa-dice"></i>
                        <span>单抽 (100)</span>
                    </button>
                    <button class="gacha-btn pulse" id="multi-gacha">
                        <i class="fas fa-dice-d20"></i>
                        <span>十抽 (999)</span>
                    </button>
                </div>
                
                <div class="gacha-results" id="gacha-results">
                    <!-- 抽卡结果会显示在这里 -->
                </div>
            </div>
        </div>
        
        <!-- 宠物仓库 -->
        <div class="section" id="collection-section">
            <h2 class="section-title">宠物</h2>
            <div class="collection-container">
                <div class="collection-stats">
                    <div>已收集: <span id="total-pokemon">0</span>/151 只</div>
                    <div>图鉴完成度: <span id="completion">0%</span></div>
                </div>
                <div class="collection-grid" id="pokemon-collection">
                    <!-- 收集的宝可梦会显示在这里 -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- 底部导航栏 -->
    <div class="tab-bar">
        <button class="tab-btn active" data-section="working">
            <i class="fas fa-briefcase"></i>
            <span>打工</span>
        </button>
        <button class="tab-btn" data-section="gacha">
            <i class="fas fa-dice"></i>
            <span>抽卡</span>
        </button>
        <button class="tab-btn" data-section="collection">
            <i class="fas fa-dragon"></i>
            <span>宠物</span>
        </button>
    </div>
    
    <!-- 设置弹窗 -->
    <div class="settings-modal" id="settings-modal">
        <div class="modal-content">
            <h2 class="modal-title">游戏设置</h2>
            
            <div class="modal-actions">
                <button class="modal-btn reset-btn" id="reset-game">
                    <i class="fas fa-trash-alt"></i> 重置游戏
                </button>
                <button class="modal-btn close-btn" id="close-modal">
                    <i class="fas fa-times"></i> 关闭
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // 游戏数据
        const gameData = {
            points: 100,
            pokemons: [],
            workingSlots: [null, null, null, null], // 增加为4个槽位
            lastUpdate: Date.now(),
            
            // 稀有度配置
            rarities: [
                { name: '灰色', color: 'gray', rate: 40, earning: 1, value: 5 },
                { name: '绿色', color: 'green', rate: 30, earning: 2, value: 10 },
                { name: '蓝色', color: 'blue', rate: 20, earning: 3, value: 20 },
                { name: '紫色', color: 'purple', rate: 10, earning: 5, value: 50 },
                { name: '红色', color: 'red', rate: 2.5, earning: 10, value: 100 },
                { name: '彩色', color: 'rainbow', rate: 0.1, earning: 20, value: 500 }
            ],
            
            // 完整的151只第一代宝可梦
            pokemonList: [
                { id: 1, name: '妙蛙种子', rarity: 'green' },
                { id: 2, name: '妙蛙草', rarity: 'green' },
                { id: 3, name: '妙蛙花', rarity: 'blue' },
                { id: 4, name: '小火龙', rarity: 'green' },
                { id: 5, name: '火恐龙', rarity: 'green' },
                { id: 6, name: '喷火龙', rarity: 'blue' },
                { id: 7, name: '杰尼龟', rarity: 'green' },
                { id: 8, name: '卡咪龟', rarity: 'green' },
                { id: 9, name: '水箭龟', rarity: 'blue' },
                { id: 10, name: '绿毛虫', rarity: 'gray' },
                { id: 11, name: '铁甲蛹', rarity: 'gray' },
                { id: 12, name: '巴大蝶', rarity: 'green' },
                { id: 13, name: '独角虫', rarity: 'gray' },
                { id: 14, name: '铁壳蛹', rarity: 'gray' },
                { id: 15, name: '大针蜂', rarity: 'green' },
                { id: 16, name: '波波', rarity: 'gray' },
                { id: 17, name: '比比鸟', rarity: 'gray' },
                { id: 18, name: '大比鸟', rarity: 'green' },
                { id: 19, name: '小拉达', rarity: 'gray' },
                { id: 20, name: '拉达', rarity: 'gray' },
                { id: 21, name: '烈雀', rarity: 'gray' },
                { id: 22, name: '大嘴雀', rarity: 'green' },
                { id: 23, name: '阿柏蛇', rarity: 'gray' },
                { id: 24, name: '阿柏怪', rarity: 'green' },
                { id: 25, name: '皮卡丘', rarity: 'purple' },
                { id: 26, name: '雷丘', rarity: 'purple' },
                { id: 27, name: '穿山鼠', rarity: 'gray' },
                { id: 28, name: '穿山王', rarity: 'green' },
                { id: 29, name: '尼多兰', rarity: 'gray' },
                { id: 30, name: '尼多娜', rarity: 'green' },
                { id: 31, name: '尼多后', rarity: 'blue' },
                { id: 32, name: '尼多朗', rarity: 'gray' },
                { id: 33, name: '尼多力诺', rarity: 'green' },
                { id: 34, name: '尼多王', rarity: 'blue' },
                { id: 35, name: '皮皮', rarity: 'purple' },
                { id: 36, name: '皮可西', rarity: 'purple' },
                { id: 37, name: '六尾', rarity: 'blue' },
                { id: 38, name: '九尾', rarity: 'blue' },
                { id: 39, name: '胖丁', rarity: 'blue' },
                { id: 40, name: '胖可丁', rarity: 'blue' },
                { id: 41, name: '超音蝠', rarity: 'gray' },
                { id: 42, name: '大嘴蝠', rarity: 'green' },
                { id: 43, name: '走路草', rarity: 'gray' },
                { id: 44, name: '臭臭花', rarity: 'green' },
                { id: 45, name: '霸王花', rarity: 'green' },
                { id: 46, name: '派拉斯', rarity: 'gray' },
                { id: 47, name: '派拉斯特', rarity: 'green' },
                { id: 48, name: '毛球', rarity: 'gray' },
                { id: 49, name: '摩鲁蛾', rarity: 'green' },
                { id: 50, name: '地鼠', rarity: 'gray' },
                { id: 51, name: '三地鼠', rarity: 'green' },
                { id: 52, name: '喵喵', rarity: 'gray' },
                { id: 53, name: '猫老大', rarity: 'green' },
                { id: 54, name: '可达鸭', rarity: 'blue' },
                { id: 55, name: '哥达鸭', rarity: 'blue' },
                { id: 56, name: '猴怪', rarity: 'green' },
                { id: 57, name: '火暴猴', rarity: 'green' },
                { id: 58, name: '卡蒂狗', rarity: 'blue' },
                { id: 59, name: '风速狗', rarity: 'blue' },
                { id: 60, name: '蚊香蝌蚪', rarity: 'gray' },
                { id: 61, name: '蚊香君', rarity: 'green' },
                { id: 62, name: '蚊香泳士', rarity: 'green' },
                { id: 63, name: '凯西', rarity: 'purple' },
                { id: 64, name: '勇基拉', rarity: 'purple' },
                { id: 65, name: '胡地', rarity: 'purple' },
                { id: 66, name: '腕力', rarity: 'purple' },
                { id: 67, name: '豪力', rarity: 'purple' },
                { id: 68, name: '怪力', rarity: 'purple' },
                { id: 69, name: '喇叭芽', rarity: 'gray' },
                { id: 70, name: '口呆花', rarity: 'green' },
                { id: 71, name: '大食花', rarity: 'green' },
                { id: 72, name: '玛瑙水母', rarity: 'gray' },
                { id: 73, name: '毒刺水母', rarity: 'green' },
                { id: 74, name: '小拳石', rarity: 'gray' },
                { id: 75, name: '隆隆石', rarity: 'green' },
                { id: 76, name: '隆隆岩', rarity: 'green' },
                { id: 77, name: '小火马', rarity: 'blue' },
                { id: 78, name: '烈焰马', rarity: 'blue' },
                { id: 79, name: '呆呆兽', rarity: 'blue' },
                { id: 80, name: '呆壳兽', rarity: 'blue' },
                { id: 81, name: '小磁怪', rarity: 'blue' },
                { id: 82, name: '三合一磁怪', rarity: 'blue' },
                { id: 83, name: '大葱鸭', rarity: 'green' },
                { id: 84, name: '嘟嘟', rarity: 'green' },
                { id: 85, name: '嘟嘟利', rarity: 'green' },
                { id: 86, name: '小海狮', rarity: 'blue' },
                { id: 87, name: '白海狮', rarity: 'blue' },
                { id: 88, name: '臭泥', rarity: 'gray' },
                { id: 89, name: '臭臭泥', rarity: 'green' },
                { id: 90, name: '大舌贝', rarity: 'gray' },
                { id: 91, name: '刺甲贝', rarity: 'green' },
                { id: 92, name: '鬼斯', rarity: 'purple' },
                { id: 93, name: '鬼斯通', rarity: 'purple' },
                { id: 94, name: '耿鬼', rarity: 'purple' },
                { id: 95, name: '大岩蛇', rarity: 'purple' },
                { id: 96, name: '催眠貘', rarity: 'purple' },
                { id: 97, name: '引梦貘人', rarity: 'purple' },
                { id: 98, name: '大钳蟹', rarity: 'gray' },
                { id: 99, name: '巨钳蟹', rarity: 'green' },
                { id: 100, name: '霹雳电球', rarity: 'blue' },
                { id: 101, name: '顽皮雷弹', rarity: 'blue' },
                { id: 102, name: '蛋蛋', rarity: 'purple' },
                { id: 103, name: '椰蛋树', rarity: 'purple' },
                { id: 104, name: '卡拉卡拉', rarity: 'red' },
                { id: 105, name: '嘎啦嘎啦', rarity: 'red' },
                { id: 106, name: '飞腿郎', rarity: 'red' },
                { id: 107, name: '快拳郎', rarity: 'red' },
                { id: 108, name: '大舌头', rarity: 'red' },
                { id: 109, name: '瓦斯弹', rarity: 'gray' },
                { id: 110, name: '双弹瓦斯', rarity: 'green' },
                { id: 111, name: '独角犀牛', rarity: 'purple' },
                { id: 112, name: '钻角犀兽', rarity: 'purple' },
                { id: 113, name: '吉利蛋', rarity: 'red' },
                { id: 114, name: '蔓藤怪', rarity: 'purple' },
                { id: 115, name: '袋兽', rarity: 'red' },
                { id: 116, name: '墨海马', rarity: 'blue' },
                { id: 117, name: '海刺龙', rarity: 'blue' },
                { id: 118, name: '角金鱼', rarity: 'gray' },
                { id: 119, name: '金鱼王', rarity: 'green' },
                { id: 120, name: '海星星', rarity: 'blue' },
                { id: 121, name: '宝石海星', rarity: 'blue' },
                { id: 122, name: '魔墙人偶', rarity: 'red' },
                { id: 123, name: '飞天螳螂', rarity: 'red' },
                { id: 124, name: '迷唇姐', rarity: 'purple' },
                { id: 125, name: '电击兽', rarity: 'purple' },
                { id: 126, name: '鸭嘴火兽', rarity: 'purple' },
                { id: 127, name: '凯罗斯', rarity: 'red' },
                { id: 128, name: '肯泰罗', rarity: 'red' },
                { id: 129, name: '鲤鱼王', rarity: 'gray' },
                { id: 130, name: '暴鲤龙', rarity: 'blue' },
                { id: 131, name: '拉普拉斯', rarity: 'rainbow' },
                { id: 132, name: '百变怪', rarity: 'rainbow' },
                { id: 133, name: '伊布', rarity: 'rainbow' },
                { id: 134, name: '水伊布', rarity: 'rainbow' },
                { id: 135, name: '雷伊布', rarity: 'rainbow' },
                { id: 136, name: '火伊布', rarity: 'rainbow' },
                { id: 137, name: '多边兽', rarity: 'rainbow' },
                { id: 138, name: '菊石兽', rarity: 'red' },
                { id: 139, name: '多刺菊石兽', rarity: 'red' },
                { id: 140, name: '化石盔', rarity: 'red' },
                { id: 141, name: '镰刀盔', rarity: 'red' },
                { id: 142, name: '化石翼龙', rarity: 'rainbow' },
                { id: 143, name: '卡比兽', rarity: 'rainbow' },
                { id: 144, name: '急冻鸟', rarity: 'rainbow' },
                { id: 145, name: '闪电鸟', rarity: 'rainbow' },
                { id: 146, name: '火焰鸟', rarity: 'rainbow' },
                { id: 147, name: '迷你龙', rarity: 'rainbow' },
                { id: 148, name: '哈克龙', rarity: 'rainbow' },
                { id: 149, name: '快龙', rarity: 'rainbow' },
                { id: 150, name: '超梦', rarity: 'rainbow' },
                { id: 151, name: '梦幻', rarity: 'rainbow' }
            ]
        };
        
        // 初始化游戏
        function initGame() {
            loadGameData();
            setupEventListeners();
            renderWorkingSection();
            renderCollectionSection();
            startEarningLoop();
            updatePointsDisplay();
        }
        
        // 加载游戏数据
        function loadGameData() {
            const savedData = localStorage.getItem('pokemonGachaGame');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                Object.assign(gameData, parsedData);
                
                // 计算离线收益
                const now = Date.now();
                const elapsedSeconds = Math.floor((now - gameData.lastUpdate) / 1000);
                
                if (elapsedSeconds > 0) {
                    let offlineEarnings = 0;
                    
                    gameData.workingSlots.forEach(slot => {
                        if (slot) {
                            const pokemon = gameData.pokemons.find(p => p.id === slot.id);
                            if (pokemon) {
                                const rarity = gameData.rarities.find(r => r.color === pokemon.rarity);
                                offlineEarnings += rarity.earning * elapsedSeconds;
                            }
                        }
                    });
                    
                    if (offlineEarnings > 0) {
                        gameData.points += offlineEarnings;
                        showNotification(`离线收益: +${offlineEarnings} 积分`);
                    }
                }
                
                gameData.lastUpdate = now;
                saveGameData();
            }
        }
        
        // 保存游戏数据
        function saveGameData() {
            gameData.lastUpdate = Date.now();
            localStorage.setItem('pokemonGachaGame', JSON.stringify(gameData));
        }
        
        // 设置事件监听器
        function setupEventListeners() {
            // 底部导航按钮
            document.querySelectorAll('.tab-btn').forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
                    
                    button.classList.add('active');
                    const sectionId = button.dataset.section + '-section';
                    document.getElementById(sectionId).classList.add('active');
                });
            });
            
            // 单抽按钮
            document.getElementById('single-gacha').addEventListener('click', () => {
                performGacha(1);
            });
            
            // 十连抽按钮
            document.getElementById('multi-gacha').addEventListener('click', () => {
                performGacha(10);
            });
            
            // 设置按钮
            document.getElementById('settings-btn').addEventListener('click', () => {
                document.getElementById('settings-modal').classList.add('active');
            });
            
            // 关闭模态框按钮
            document.getElementById('close-modal').addEventListener('click', () => {
                document.getElementById('settings-modal').classList.remove('active');
            });
            
            // 重置游戏按钮
            document.getElementById('reset-game').addEventListener('click', () => {
                resetGame();
            });
        }
        
        // 更新积分显示
        function updatePointsDisplay() {
            document.getElementById('points').textContent = gameData.points;
        }
        
        // 渲染打工区域
        function renderWorkingSection() {
            const slotsContainer = document.querySelector('.working-slots');
            const availableContainer = document.getElementById('available-pokemon');
            
            // 清空容器
            slotsContainer.querySelectorAll('.slot-content').forEach(content => {
                content.innerHTML = '';
            });
            
            availableContainer.innerHTML = '';
            
            // 渲染打工槽位（现在有4个）
            gameData.workingSlots.forEach((slot, index) => {
                const slotElement = document.getElementById(`slot-${index+1}`);
                const content = slotElement.querySelector('.slot-content');
                
                if (slot) {
                    const pokemon = gameData.pokemons.find(p => p.id === slot.id);
                    if (pokemon) {
                        slotElement.classList.add('occupied');
                        content.innerHTML = `
                            <div class="working-pokemon" data-slot="${index}">
                                <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemon.id}.png" alt="${pokemon.name}">
                                <div class="name rarity-${pokemon.rarity}">${pokemon.name}</div>
                                <div class="earning">+${getRarityEarning(pokemon.rarity)}/秒</div>
                            </div>
                        `;
                        
                        // 添加点击事件移除宝可梦
                        content.querySelector('.working-pokemon').addEventListener('click', (e) => {
                            e.stopPropagation();
                            removeFromWorkingSlot(index);
                        });
                    }
                } else {
                    slotElement.classList.remove('occupied');
                    content.innerHTML = '<div class="empty-slot">空闲槽位</div>';
                }
            });
            
            // 渲染可用宝可梦
            gameData.pokemons.forEach(pokemon => {
                // 检查是否已在打工
                const isWorking = gameData.workingSlots.some(slot => slot && slot.id === pokemon.id);
                
                if (!isWorking) {
                    const card = document.createElement('div');
                    card.className = 'pokemon-card';
                    card.dataset.id = pokemon.id;
                    card.innerHTML = `
                        <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemon.id}.png" alt="${pokemon.name}">
                        <div class="name rarity-${pokemon.rarity}">${pokemon.name}</div>
                    `;
                    
                    card.addEventListener('click', () => {
                        assignToWorkingSlot(pokemon.id);
                    });
                    
                    availableContainer.appendChild(card);
                }
            });
        }
        
        // 分配宝可梦到打工槽位
        function assignToWorkingSlot(pokemonId) {
            // 查找空闲槽位
            const emptySlotIndex = gameData.workingSlots.findIndex(slot => slot === null);
            
            if (emptySlotIndex !== -1) {
                gameData.workingSlots[emptySlotIndex] = { id: pokemonId, startTime: Date.now() };
                saveGameData();
                renderWorkingSection();
                showNotification('宝可梦已开始打工！');
            } else {
                showNotification('没有空闲的打工槽位！');
            }
        }
        
        // 从打工槽位移除宝可梦
        function removeFromWorkingSlot(slotIndex) {
            gameData.workingSlots[slotIndex] = null;
            saveGameData();
            renderWorkingSection();
            showNotification('宝可梦已停止打工');
        }
        
        // 获取稀有度收益
        function getRarityEarning(rarity) {
            const rarityData = gameData.rarities.find(r => r.color === rarity);
            return rarityData ? rarityData.earning : 1;
        }
        
        // 抽卡功能
        function performGacha(count) {
            const cost = count === 1 ? 100 : 999;
            
            if (gameData.points < cost) {
                showNotification('积分不足！');
                return;
            }
            
            // 扣除积分
            gameData.points -= cost;
            updatePointsDisplay();
            
            const resultsContainer = document.getElementById('gacha-results');
            resultsContainer.innerHTML = '';
            
            const results = [];
            
            for (let i = 0; i < count; i++) {
                // 随机选择稀有度
                const rand = Math.random() * 100;
                let cumulativeRate = 0;
                let selectedRarity = null;
                
                for (const rarity of gameData.rarities) {
                    cumulativeRate += rarity.rate;
                    if (rand <= cumulativeRate) {
                        selectedRarity = rarity;
                        break;
                    }
                }
                
                // 从该稀有度的宝可梦中随机选择一个
                const rarityPokemons = gameData.pokemonList.filter(p => p.rarity === selectedRarity.color);
                const randomIndex = Math.floor(Math.random() * rarityPokemons.length);
                const pokemon = {...rarityPokemons[randomIndex]};
                
                results.push(pokemon);
                
                // 创建卡牌元素（先显示背面）
                const card = document.createElement('div');
                card.className = 'gacha-card';
                card.innerHTML = `
                    <div class="rarity bg-${pokemon.rarity}"></div>
                    <div class="card-back"></div>
                `;
                resultsContainer.appendChild(card);
                
                // 设置动画延迟
                setTimeout(() => {
                    card.classList.add('reveal');
                    
                    // 延迟后显示正面
                    setTimeout(() => {
                        card.innerHTML = `
                            <div class="rarity bg-${pokemon.rarity}"></div>
                            <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemon.id}.png" alt="${pokemon.name}">
                            <div class="name rarity-${pokemon.rarity}">${pokemon.name}</div>
                        `;
                    }, 250);
                }, i * 300);
            }
            
            // 处理抽卡结果
            setTimeout(() => {
                let duplicates = 0;
                let duplicatesValue = 0;
                
                results.forEach(pokemon => {
                    // 检查是否已拥有
                    const existing = gameData.pokemons.find(p => p.id === pokemon.id);
                    
                    if (existing) {
                        duplicates++;
                        const rarityData = gameData.rarities.find(r => r.color === pokemon.rarity);
                        duplicatesValue += rarityData.value;
                    } else {
                        // 添加到收藏
                        gameData.pokemons.push({
                            id: pokemon.id,
                            name: pokemon.name,
                            rarity: pokemon.rarity,
                            obtained: Date.now()
                        });
                    }
                });
                
                // 添加重复转换的积分
                if (duplicates > 0) {
                    gameData.points += duplicatesValue;
                    updatePointsDisplay();
                    showNotification(`获得 ${duplicates} 只重复宝可梦，转换为 ${duplicatesValue} 积分！`);
                }
                
                // 保存并更新UI
                saveGameData();
                renderCollectionSection();
            }, count * 300 + 1000);
        }
        
        // 渲染收藏区域
        function renderCollectionSection() {
            const collectionContainer = document.getElementById('pokemon-collection');
            collectionContainer.innerHTML = '';
            
            // 按稀有度排序
            const sortedPokemons = [...gameData.pokemons].sort((a, b) => {
                const rarityOrder = ['rainbow', 'red', 'purple', 'blue', 'green', 'gray'];
                return rarityOrder.indexOf(a.rarity) - rarityOrder.indexOf(b.rarity);
            });
            
            // 渲染收藏的宝可梦
            sortedPokemons.forEach(pokemon => {
                const card = document.createElement('div');
                card.className = 'collection-card';
                card.innerHTML = `
                    <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemon.id}.png" alt="${pokemon.name}">
                    <div class="name rarity-${pokemon.rarity}">${pokemon.name}</div>
                    <div class="rarity-tag bg-${pokemon.rarity}">${getRarityName(pokemon.rarity)}</div>
                `;
                collectionContainer.appendChild(card);
            });
            
            // 更新统计信息
            document.getElementById('total-pokemon').textContent = gameData.pokemons.length;
            const completion = Math.min(100, Math.floor(gameData.pokemons.length / gameData.pokemonList.length * 100));
            document.getElementById('completion').textContent = `${completion}%`;
        }
        
        // 获取稀有度名称
        function getRarityName(rarity) {
            const rarityData = gameData.rarities.find(r => r.color === rarity);
            return rarityData ? rarityData.name : '';
        }
        
        // 开始赚取积分循环
        function startEarningLoop() {
            setInterval(() => {
                let totalEarnings = 0;
                
                gameData.workingSlots.forEach(slot => {
                    if (slot) {
                        const pokemon = gameData.pokemons.find(p => p.id === slot.id);
                        if (pokemon) {
                            const rarity = gameData.rarities.find(r => r.color === pokemon.rarity);
                            totalEarnings += rarity.earning;
                        }
                    }
                });
                
                if (totalEarnings > 0) {
                    gameData.points += totalEarnings;
                    updatePointsDisplay();
                    saveGameData();
                }
            }, 1000);
        }
        
        // 重置游戏
        function resetGame() {
            if (confirm('确定要重置游戏吗？所有进度都将丢失！')) {
                localStorage.removeItem('pokemonGachaGame');
                // 重置游戏数据
                gameData.points = 100;
                gameData.pokemons = [];
                gameData.workingSlots = [null, null, null, null]; // 4个槽位
                gameData.lastUpdate = Date.now();
                
                // 更新UI
                updatePointsDisplay();
                renderWorkingSection();
                renderCollectionSection();
                
                // 清除抽卡结果
                document.getElementById('gacha-results').innerHTML = '';
                
                // 关闭设置弹窗
                document.getElementById('settings-modal').classList.remove('active');
                
                showNotification('游戏已重置！');
            }
        }
        
        // 显示通知
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                background: rgba(0, 40, 80, 0.9);
                color: white;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                animation: fadeIn 0.3s ease, fadeOut 0.5s ease 2.5s forwards;
            `;
            
            // 添加动画
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(-20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 3000);
        }
        
        // 初始化游戏
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
